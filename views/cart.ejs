<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart Page</title>
    <link rel="stylesheet" href="/stylesheets/cart.css" />
</head>

<body>
<<<<<<< HEAD
    <a href="/wallet" class="wallet-btn">
        Wallet: ₹<%= user.wallet %>
    </a>
=======
>>>>>>> 220806751d1eb537ad2fdaabbd0da0803e3ae830
    <div class="cart-page">
        <div class="cart-details">
            <h1>Cart Details</h1>
            <table>
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Product</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Sub Total</th>
                        <th>Remove Product</th>
                    </tr>
                </thead>
                <tbody>
<<<<<<< HEAD
                    <% cartItems.forEach(function(item) { 
                        const priceToUse = item.bargainedPrice || item.product.pPrice;
                   %>
                   <tr>
                       <td>
                           <img class="image" src="/images/product/<%= item.product.pPhoto %>" alt="Product Image" />
                       </td>
                       <td>
                           <%= item.product.pName %>
                       </td>
                       <td>
                           ₹ <%= priceToUse %> 
                           <% if (item.bargainedPrice) { %>
                               <span style="color: green; font-size: 0.8em;">(Bargained)</span>
                           <% } %>
                       </td>
                       <td>
                           <div class="quantity-form">
                               <input type="text" class="quantity" value="<%= item.quantity %>" readonly />
                           </div>
                       </td>
                       <td>
                           ₹ <%= priceToUse * item.quantity %>
                       </td>
                       <td>
                           <form action="/removeFromCart/<%= item.product._id %>" method="POST">
                               <button type="submit">Remove</button>
                           </form>
                       </td>
                   </tr>
                   <% }); %>
                   
=======
                    <% cartItems.forEach(function(item) { %>
                        <tr>
                            <td>
                                <img class="image" src="/images/product/<%= item.product.pPhoto %>"
                                    alt="Product Image" />
                            </td>
                            <td>
                                <%= item.product.pName %>
                            </td>
                            <td>₹ <%= item.product.pPrice %>
                            </td>
                            <td>
                                <div class="quantity-form">
                                    <input type="text" class="quantity" value="<%= item.quantity %>" readonly />
                                </div>
                            </td>
                            <td>₹ <%= item.product.pPrice * item.quantity %>
                            </td>
                            <td>
                                <form action="/removeFromCart/<%= item.product._id %>" method="POST">
                                    <button type="submit">Remove</button>
                                </form>
                            </td>
                        </tr>
                        <% }); %>
>>>>>>> 220806751d1eb537ad2fdaabbd0da0803e3ae830
                            <tr>
                                <td colspan="4">Total</td>
                                <td>₹ <%= totalPrice %>
                                </td>
                                <td>
<<<<<<< HEAD
                                    <form id="payNowForm" action="/pay-now/<%= user._id %>" method="GET" onsubmit="return confirmWalletPayment();">
                                        <input type="hidden" name="totalPrice" value="<%= totalPrice %>">
                                        <button class="paynow-btn" type="submit">Pay Now</button>
                                      </form>
                                      
                                      
                                      
=======
                                    <a href="/pay-now/<%= user._id %>?totalPrice=<%= totalPrice %>">
                                        <button class="paynow-btn" type="submit">Pay Now</button>
                                    </a>
>>>>>>> 220806751d1eb537ad2fdaabbd0da0803e3ae830

                                </td>
                            </tr>
                </tbody>
            </table>
        </div>
    </div>
<<<<<<< HEAD
    <script>
        function confirmWalletPayment() {
            const total = totalPrice;
            const wallet = user.wallet;
    
            if (wallet < total) {
                alert(`Insufficient wallet balance.\nYour Wallet: ₹${wallet}\nTotal Price: ₹${total}`);
                return false;
            }
    
            return confirm(`This will deduct ₹${total} from your wallet (Current Balance: ₹${wallet}). Proceed?`);
        }
    </script>
    
      
</body>


=======
</body>

>>>>>>> 220806751d1eb537ad2fdaabbd0da0803e3ae830
</html>